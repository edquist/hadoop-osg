<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Oct 16, 2012 -->
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Hadoop Map Reduce Next Generation-2.0.0-cdh4.1.1 - Fair Scheduler</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
        <meta name="Date-Revision-yyyymmdd" content="20121016" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      </head>
  <body class="composite">
    <div id="banner">
                  <a href="http://hadoop.apache.org/" id="bannerLeft">
                                        <img src="http://hadoop.apache.org/images/hadoop-logo.jpg" alt="" />
                </a>
                        <a href="http://www.apache.org/" id="bannerRight">
                                        <img src="http://www.apache.org/images/asf_logo_wide.png" alt="" />
                </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                                <div class="xleft">
                          <a href="http://www.apache.org/" class="externalLink">Apache</a>
                &gt;
                      <a href="http://hadoop.apache.org/" class="externalLink">Hadoop</a>
                &gt;
                      <a href="../">hadoop-yarn</a>
                &gt;
                Apache Hadoop 2.0.0-cdh4.1.1
                </div>
            <div class="xright">            <a href="http://wiki.apache.org/hadoop" class="externalLink">Wiki</a>
            |
                <a href="https://svn.apache.org/repos/asf/hadoop/" class="externalLink">SVN</a>
            |
                <a href="http://hadoop.apache.org/" class="externalLink">Apache Hadoop</a>
              
                                &nbsp;| Last Published: 2012-10-16
              &nbsp;| Version: 2.0.0-cdh4.1.1
            </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                                                <h5>Common</h5>
                  <ul>
                  <li class="none">
                  <a href="../../index.html">Overview</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/SingleCluster.html">Single Node Setup</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/ClusterSetup.html">Cluster Setup</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/commands_manual.html">Hadoop Commands</a>
            </li>
          </ul>
                       <h5>HDFS</h5>
                  <ul>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/HDFSHighAvailabilityWithQJM.html">High Availability With QJM</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/HDFSHighAvailabilityWithNFS.html">High Availability With NFS</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/Federation.html">Federation</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/WebHDFS.html">WebHDFS REST API</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-hdfs-httpfs/index.html">HttpFS Gateway</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/hdfs_user_guide.html">HDFS User Guide</a>
            </li>
          </ul>
                       <h5>Yarn/MapReduce</h5>
                  <ul>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/YARN.html">YARN Architecture</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/WritingYarnApplications.html">Writing Yarn Applications</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/CapacityScheduler.html">Capacity Scheduler</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/WebApplicationProxy.html">Web Application Proxy</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/EncryptedShuffle.html">Encrypted Shuffle</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/YarnCommands.html">Yarn Commands</a>
            </li>
          </ul>
                       <h5>YARN REST API's</h5>
                  <ul>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/WebServicesIntro.html">Introduction</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/ResourceManagerRest.html">Resource Manager</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/NodeManagerRest.html">Node Manager</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/MapredAppMasterRest.html">Mapreduce Application Master</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-site/HistoryServerRest.html">History Server</a>
            </li>
          </ul>
                       <h5>Auth</h5>
                  <ul>
                  <li class="none">
                  <a href="../../hadoop-auth/index.html">Overview</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-auth/Examples.html">Examples</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-auth/Configuration.html">Configuration</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-auth/BuildingIt.html">Building</a>
            </li>
          </ul>
                       <h5>Reference</h5>
                  <ul>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/releasenotes.html">Release Notes</a>
            </li>
                  <li class="none">
                  <a href="../../api/index.html">API docs</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/CHANGES.txt">Common CHANGES.txt</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/CHANGES.txt">HDFS CHANGES.txt</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-mapreduce/CHANGES.txt">MapReduce CHANGES.txt</a>
            </li>
          </ul>
                       <h5>Configuration</h5>
                  <ul>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/core-default.xml">core-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-hdfs/hdfs-default.xml">hdfs-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-yarn/hadoop-yarn-common/yarn-default.xml">yarn-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-mapreduce-client/hadoop-mapreduce-client-core/mapred-default.xml">mapred-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../hadoop-project-dist/hadoop-common/DeprecatedProperties.html">Deprecated Properties</a>
            </li>
          </ul>
                                 <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
          <img alt="Built by Maven" src="./images/logos/maven-feather.png"/>
        </a>
                       
                            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <!-- Licensed under the Apache License, Version 2.0 (the "License"); --><!-- you may not use this file except in compliance with the License. --><!-- You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, software --><!-- distributed under the License is distributed on an "AS IS" BASIS, --><!-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. --><!-- See the License for the specific language governing permissions and --><!-- limitations under the License. See accompanying LICENSE file. --><div class="section"><h2>Hadoop MapReduce Next Generation - Fair Scheduler<a name="Hadoop_MapReduce_Next_Generation_-_Fair_Scheduler"></a></h2><p>[ <a href="./index.html">Go Back</a> ]</p><ul><li><a href="#Hadoop_MapReduce_Next_Generation_-_Fair_Scheduler">Hadoop MapReduce Next Generation - Fair Scheduler</a><ul><li><a href="#Purpose">Purpose </a></li><li><a href="#Introduction">Introduction</a></li><li><a href="#Installation">Installation</a></li><li><a href="#Configuration">Configuration</a></li></ul></li></ul><div class="section"><h3><a name="Purpose">Purpose</a> </h3><p>This document describes the <tt>FairScheduler</tt>, a pluggable scheduler for Hadoop which provides a way to share large clusters. <b>NOTE:</b> The Fair Scheduler implementation is currently under development and should be considered experimental.</p></div><div class="section"><h3><a name="Introduction">Introduction</a></h3><p>Fair scheduling is a method of assigning resources to applications such that all apps get, on average, an equal share of resources over time. Hadoop NextGen is capable of scheduling multiple resource types, such as Memory and CPU. Currently only memory is supported, so a &quot;cluster share&quot; is a proportion of aggregate memory in the cluster. When there is a single app running, that app uses the entire cluster. When other apps are submitted, resources that free up are assigned to the new apps, so that each app gets roughly the same amount of resources. Unlike the default Hadoop scheduler, which forms a queue of apps, this lets short apps finish in reasonable time while not starving long-lived apps. It is also a reasonable way to share a cluster between a number of users. Finally, fair sharing can also work with app priorities - the priorities are used as weights to determine the fraction of total resources that each app should get.</p><p>The scheduler organizes apps further into &quot;queues&quot;, and shares resources fairly between these queues. By default, all users share a single queue, called &#x201c;default&#x201d;. If an app specifically lists a queue in a container resource request, the request is submitted to that queue. It is also possible to assign queues based on the user name included with the request through configuration. Within each queue, fair sharing is used to share capacity between the running apps. queues can also be given weights to share the cluster non-proportionally in the config file.</p><p>In addition to providing fair sharing, the Fair Scheduler allows assigning guaranteed minimum shares to queues, which is useful for ensuring that certain users, groups or production applications always get sufficient resources. When a queue contains apps, it gets at least its minimum share, but when the queue does not need its full guaranteed share, the excess is split between other running apps. This lets the scheduler guarantee capacity for queues while utilizing resources efficiently when these queues don't contain applications.</p><p>The Fair Scheduler lets all apps run by default, but it is also possible to limit the number of running apps per user and per queue through the config file. This can be useful when a user must submit hundreds of apps at once, or in general to improve performance if running too many apps at once would cause too much intermediate data to be created or too much context-switching. Limiting the apps does not cause any subsequently submitted apps to fail, only to wait in the scheduler's queue until some of the user's earlier apps finish. apps to run from each user/queue are chosen in order of priority and then submit time, as in the default FIFO scheduler in Hadoop.</p><p>Certain add-ons are not yet supported which existed in the original (MR1) Fair Scheduler. Among them, is the use of a custom policies governing priority &#x201c;boosting&#x201d; over certain apps. </p></div><div class="section"><h3><a name="Installation">Installation</a></h3><p>To use the Fair Scheduler first assign the appropriate scheduler class in yarn-site.xml:</p><div><pre>&lt;property&gt;
  &lt;name&gt;yarn.resourcemanager.scheduler.class&lt;/name&gt;
  &lt;value&gt;org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.FairScheduler&lt;/value&gt;
&lt;/property&gt;</pre></div></div><div class="section"><h3><a name="Configuration">Configuration</a></h3><p>Customizing the Fair Scheduler typically involves altering two files. First, scheduler-wide options can be set by adding configuration properties in the fair-scheduler.xml file in your existing configuration directory. Second, in most cases users will want to create a manifest file listing which queues exist and their respective weights and capacities. The location of this file is flexible - but it must be declared in fair-scheduler.xml. </p><ul><li><tt>yarn.scheduler.fair.allocation.file</tt><ul><li>Path to allocation file. An allocation file is an XML manifest describing queues and their properties, in addition to certain policy defaults. This file must be in XML format as described in the next section.</li></ul></li><li><tt>yarn.scheduler.fair.minimum-allocation-mb</tt><ul><li>The smallest container size the scheduler can allocate, in MB of memory.</li></ul></li><li><tt>yarn.scheduler.fair.minimum-allocation-mb</tt><ul><li>The largest container the scheduler can allocate, in MB of memory.</li></ul></li><li><tt>yarn.scheduler.fair.user-as-default-queue</tt><ul><li>Whether to use the username associated with the allocation as the default queue name, in the event that a queue name is not specified. If this is set to &quot;false&quot; or unset, all jobs have a shared default queue, called &quot;default&quot;.</li></ul></li><li><tt>yarn.scheduler.fair.preemption</tt><ul><li>Whether to use preemption. Note that preemption is experimental in the current version.</li></ul></li><li><tt>yarn.scheduler.fair.sizebasedweight</tt><ul><li>Whether to assign shares to individual apps based on their size, rather than providing an equal share to all apps regardless of size.</li></ul></li><li><tt>yarn.scheduler.fair.assignmultiple</tt><ul><li>Whether to allow multiple container assignments in one heartbeat.</li></ul></li></ul></div></div><div class="section"><h2>Allocation file format<a name="Allocation_file_format"></a></h2><p>The allocation file must be in XML format. The format contains three types of elements:</p><ul><li><b>Queue elements</b>, which represent queues. Each may contain the following properties:<ul><li>minResources: minimum amount of aggregate memory</li><li>maxResources: maximum amount of aggregate memory</li><li>maxRunningApps: limit the number of apps from the queue to run at once</li><li>weight: to share the cluster non-proportionally with other queues</li><li>schedulingMode: either &quot;fifo&quot; or &quot;fair&quot; depending on the in-queue scheduling policy desired</li></ul></li><li><b>User elements</b>, which represent settings governing the behavior of individual users. They can contain a single property: maxRunningApps, a limit on the number of running apps for a particular user.</li><li><b>A userMaxAppsDefault element</b>, which sets the default running app limit for any users whose limit is not otherwise specified.<p>An example allocation file is given here:</p><div><pre>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;allocations&gt;
  &lt;queue name=&quot;sample_queue&quot;&gt;
    &lt;minResources&gt;100000&lt;/minResources&gt;
    &lt;maxResources&gt;900000&lt;/maxResources&gt;
    &lt;maxRunningApps&gt;50&lt;/maxRunningApps&gt;
    &lt;weight&gt;2.0&lt;/weight&gt;
    &lt;schedulingMode&gt;fair&lt;/schedulingMode&gt;
  &lt;/queue&gt;
  &lt;user name=&quot;sample_user&quot;&gt;
    &lt;maxRunningApps&gt;30&lt;/maxRunningApps&gt;
  &lt;/user&gt;
  &lt;userMaxAppsDefault&gt;5&lt;/userMaxAppsDefault&gt;
&lt;/allocations&gt;</pre></div><p>Note that for backwards compatibility with the original FairScheduler, &quot;queue&quot; elements can instead be named as &quot;pool&quot; elements.</p></li></ul></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;            2012
              Apache Software Foundation
            
                       - <a href="http://maven.apache.org/privacy-policy.html">Privacy Policy</a></div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
